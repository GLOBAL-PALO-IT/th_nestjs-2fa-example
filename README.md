# NestJS Two-Factor Authentication Demo

This is a demonstration of implementing Two-Factor Authentication (2FA) in a NestJS application.

## Features

- User registration and authentication with JWT
- Two-Factor Authentication (2FA) implementation using the speakeasy library
- Enable/disable 2FA functionality for user accounts
- Token validation for 2FA

## Project Setup

```bash
# Install dependencies
$ npm install

# Start the PostgreSQL database using Docker
$ docker-compose up -d
```

## Running the App

```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## API Endpoints

### Authentication Endpoints

- `POST /auth/register` - Register a new user
- `POST /auth/login` - Login with email and password
- `GET /auth/enable-2fa` - Enable 2FA for logged-in user
- `POST /auth/validate-2fa` - Validate a 2FA token
- `GET /auth/disable-2fa` - Disable 2FA for logged-in user

### User Endpoints

- `POST /users` - Create a new user
- `GET /users/:email` - Get user by email
- `GET /users/id/:id` - Get user by ID

## How 2FA Works

1. User enables 2FA via `/auth/enable-2fa` endpoint
2. The server generates a secret key using speakeasy
3. This key should be shared with the user to set up in an authenticator app
4. When logging in, after successful password verification, user must provide a token generated by their authenticator app
5. The server validates the token using the stored secret key

## License

This project is [MIT licensed](LICENSE).
